<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Layout with Tailwind CSS</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title><%= meta_title %></title>
    <meta name="description" content="<%= meta_description %>">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="<%= request.original_url %>">
    <meta property="og:title" content="<%= meta_title %>">
    <meta property="og:description" content="<%= meta_description %>">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="<%= request.original_url %>">
    <meta name="twitter:title" content="<%= meta_title %>">
    <meta name="twitter:description" content="<%= meta_description %>">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="<%= request.original_url %>" />
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  </head>

  <body class="bg-gray-50 text-gray-900 font-sans antialiased">
    <div id="notifications" class="fixed top-4 right-4 z-50 space-y-2"></div>
    
    <div class="min-h-screen flex flex-col bg-stone-50">
      <%= render 'shared/navbar' %>
      
      <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <%= render 'shared/flash' %>
        <%= yield %>
      </main>
      
      <%= render 'shared/footer' %>
      <%= render 'shared/whatsapp_widget' %>
    </div>
    <%= yield :scripts %>

    <!-- Root element of PhotoSwipe -->
    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="pswp__bg"></div>
      <div class="pswp__scroll-wrap">
        <div class="pswp__container">
          <div class="pswp__item"></div>
          <div class="pswp__item"></div>
          <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
          <div class="pswp__top-bar">
            <div class="pswp__counter"></div>
            <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
            <button class="pswp__button pswp__button--share" title="Share"></button>
            <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
            <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
            <div class="pswp__preloader">
              <div class="pswp__preloader__icn">
                <div class="pswp__preloader__cut">
                  <div class="pswp__preloader__donut"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
            <div class="pswp__share-tooltip"></div>
          </div>
          <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
          <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>
          <div class="pswp__caption">
            <div class="pswp__caption__center"></div>
          </div>
        </div>
      </div>
    </div>
    <%= turbo_frame_tag "modal" %>

    <!-- Frame pour la modale -->
    <div id="modal-container"></div>
    <%= turbo_frame_tag "modal" do %>
      <%= render "shared/modal" %>
    <% end %>

    <!-- Modal containers -->
    <div id="home-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full flex items-center justify-center">
      <!-- Modal content will be injected here -->
    </div>

    <div id="service-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 overflow-y-auto">
      <div class="flex items-center justify-center min-h-screen p-4">
        <!-- Le contenu sera injecté ici -->
      </div>
    </div>

    <script>
      function showHomeService(name, description, type) {
        const modal = document.getElementById('home-modal');
        
        if (type === 'tesisat' || type === 'boya') {
          const content = `
            <div class="relative bg-white rounded-xl shadow-2xl max-w-4xl mx-auto w-full overflow-y-auto">
              <!-- Header avec Swiper -->
              <div class="relative h-40 md:h-64">
                <div class="swiper-container h-full">
                  <div class="swiper-wrapper">
                    <div class="swiper-slide relative">
                      <img src="/assets/services/sanitary1.png" class="w-full h-full object-cover" alt="Tesisat Hizmetleri">
                      <div class="absolute inset-0 bg-gradient-to-t from-black/75 to-transparent"></div>
                      <div class="absolute bottom-8 left-8 text-white">
                        <h3 class="text-2xl md:text-3xl font-bold mb-1">Tesisat Hizmetleri</h3>
                        <p class="text-base md:text-lg text-white/80">Profesyonel tesisat çözümleri</p>
                      </div>
                    </div>
                    <div class="swiper-slide relative">
                      <img src="/assets/services/sanitary2.webp" class="w-full h-full object-cover" alt="Tesisat 2">
                      <div class="absolute inset-0 bg-gradient-to-t from-black/75 to-transparent"></div>
                    </div>
                    <div class="swiper-slide relative">
                      <img src="/assets/services/sanitary3.webp" class="w-full h-full object-cover" alt="Tesisat 3">
                      <div class="absolute inset-0 bg-gradient-to-t from-black/75 to-transparent"></div>
                    </div>
                  </div>
                  <div class="swiper-pagination"></div>
                  <div class="swiper-button-next hidden md:flex"></div>
                  <div class="swiper-button-prev hidden md:flex"></div>
                </div>
              </div>

              <!-- Content -->
              <div class="p-4 md:p-6">
                <!-- Services Grid -->
                <div class="mb-4 md:mb-6">
                  <h4 class="text-base md:text-lg font-semibold text-gray-900 mb-3 md:mb-4">
                    ${type === 'tesisat' ? 'Tesisat' : 'Boya'} Hizmetlerimiz
                  </h4>
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-6">
                    <div class="bg-gray-50 rounded-lg p-4 md:p-6 hover:bg-emerald-50 transition-all duration-300">
                      <div class="flex items-start space-x-4">
                        <div class="flex-shrink-0">
                          <div class="p-3 bg-emerald-100 rounded-lg">
                            <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
                            </svg>
                          </div>
                        </div>
                        <div>
                          <h5 class="font-medium text-gray-900 mb-2">Su Tesisatı</h5>
                          <p class="text-gray-600">Su kaçağı tespiti ve onarımı</p>
                        </div>
                      </div>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-4 md:p-6 hover:bg-emerald-50 transition-all duration-300">
                      <div class="flex items-start space-x-4">
                        <div class="flex-shrink-0">
                          <div class="p-3 bg-emerald-100 rounded-lg">
                            <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                          </div>
                        </div>
                        <div>
                          <h5 class="font-medium text-gray-900 mb-2">Tıkanıklık Açma</h5>
                          <p class="text-gray-600">Kırmadan tıkanıklık açma</p>
                        </div>
                      </div>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-4 md:p-6 hover:bg-emerald-50 transition-all duration-300">
                      <div class="flex items-start space-x-4">
                        <div class="flex-shrink-0">
                          <div class="p-3 bg-emerald-100 rounded-lg">
                            <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10a7 7 0 0114 0v2a7 7 0 11-14 0v-2zM8 16h8M8 12h8M8 8h8"/>
                            </svg>
                          </div>
                        </div>
                        <div>
                          <h5 class="font-medium text-gray-900 mb-2">Kaçak Tespiti</h5>
                          <p class="text-gray-600">Cihazla kaçak tespiti</p>
                        </div>
                      </div>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-4 md:p-6 hover:bg-emerald-50 transition-all duration-300">
                      <div class="flex items-start space-x-4">
                        <div class="flex-shrink-0">
                          <div class="p-3 bg-emerald-100 rounded-lg">
                            <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                            </svg>
                          </div>
                        </div>
                        <div>
                          <h5 class="font-medium text-gray-900 mb-2">Pis Su Tesisatı</h5>
                          <p class="text-gray-600">Gider ve kanal temizliği</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Actions -->
                <div class="flex flex-col md:flex-row md:items-center justify-between gap-3 pt-3 md:pt-4 border-t border-gray-200">
                  <a href="${type === 'tesisat' ? '/hizmetler/tesisat' : '/hizmetler/boya'}" 
                     class="group inline-flex items-center justify-center px-4 md:px-6 py-3 bg-emerald-600 text-white text-base md:text-lg font-medium rounded-lg hover:bg-emerald-700 transition-all duration-300 w-full md:w-auto">
                    <span>Tüm ${type === 'tesisat' ? 'Tesisat' : 'Boya'} Hizmetleri</span>
                    <svg class="w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                  </a>

                  <div class="flex flex-col md:flex-row gap-2 md:gap-4 w-full md:w-auto">
                    <a href="/customer_inquiries/new?service=${type}" 
                       class="inline-flex items-center justify-center px-4 md:px-6 py-3 bg-emerald-100 text-emerald-700 text-base md:text-lg font-medium rounded-lg hover:bg-emerald-200 transition-all duration-300 w-full md:w-auto">
                      Teklif Al
                    </a>
                    
                    <a href="tel:+905555555555" 
                       class="inline-flex items-center justify-center px-4 md:px-6 py-3 border-2 border-emerald-600 text-emerald-600 text-base md:text-lg font-medium rounded-lg hover:bg-emerald-50 transition-all duration-300 w-full md:w-auto">
                      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                      </svg>
                      Hemen Ara
                    </a>
                  </div>
                </div>
              </div>

              <!-- Close button -->
              <button onclick="closeModal('home-modal')" 
                      class="absolute top-2 right-2 md:top-4 md:right-4 p-2 md:p-3 bg-white/80 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-colors z-50">
                <span class="sr-only">Kapat</span>
                <svg class="w-5 h-5 md:w-6 md:h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
          `;

          modal.innerHTML = content;
          modal.classList.remove('hidden');
          document.body.classList.add('overflow-hidden');

          // Initialize Swiper with responsive options
          new Swiper('.swiper-container', {
            loop: true,
            autoplay: {
              delay: 3000,
              disableOnInteraction: false,
            },
            pagination: {
              el: '.swiper-pagination',
              clickable: true,
            },
            navigation: {
              nextEl: '.swiper-button-next',
              prevEl: '.swiper-button-prev',
              enabled: window.innerWidth >= 768, // Enable navigation only on desktop
            },
            breakpoints: {
              // Mobile
              320: {
                slidesPerView: 1,
                spaceBetween: 10
              },
              // Tablet
              768: {
                slidesPerView: 1,
                spaceBetween: 20
              }
            }
          });
        }
      }

      // Fonction pour la modale des services
      function showServiceDetails(name, description, image) {
        const modal = document.getElementById('service-modal');
        const content = `
          <div class="inline-block w-full max-w-4xl bg-white rounded-2xl shadow-xl transform transition-all">
            <!-- Header -->
            <div class="relative h-72">
              <img src="${image}" class="w-full h-full object-cover rounded-t-2xl" alt="${name}">
              <div class="absolute inset-0 bg-gradient-to-t from-black/75 to-transparent rounded-t-2xl"></div>
              <div class="absolute bottom-0 left-0 p-8">
                <h3 class="text-3xl font-bold text-white mb-2">${name}</h3>
              </div>
            </div>

            <!-- Content -->
            <div class="p-8">
              <div class="prose max-w-none">
                <p class="text-gray-600 text-lg leading-relaxed">${description}</p>
              </div>

              <!-- Actions -->
              <div class="flex items-center justify-end space-x-4 mt-6 pt-6 border-t border-gray-200">
                <a href="/contact/new?service=${encodeURIComponent(name)}" 
                   class="inline-flex items-center px-6 py-3 bg-emerald-600 text-white text-lg font-medium rounded-lg hover:bg-emerald-700 transition-colors">
                  Teklif Al
                </a>
                
                <a href="tel:+905555555555" 
                   class="inline-flex items-center px-6 py-3 border-2 border-emerald-600 text-emerald-600 text-lg font-medium rounded-lg hover:bg-emerald-50 transition-colors">
                  Hemen Ara
                </a>
              </div>
            </div>

            <!-- Close Button -->
            <button onclick="closeModal('service-modal')" class="absolute top-4 right-4 text-white hover:text-gray-200">
              <span class="sr-only">Kapat</span>
              <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        `;

        modal.querySelector('div').innerHTML = content;
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      }

      // Fonction générique pour fermer les modales
      function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
        document.body.style.overflow = '';
      }

      // Event listeners pour fermer les modales en cliquant à l'extérieur
      document.addEventListener('DOMContentLoaded', function() {
        ['home-modal', 'service-modal'].forEach(modalId => {
          const modal = document.getElementById(modalId);
          if (modal) {
            modal.addEventListener('click', function(e) {
              if (e.target === this) {
                closeModal(modalId);
              }
            });
          }
        });
      });
    </script>
  </body>
</html>
